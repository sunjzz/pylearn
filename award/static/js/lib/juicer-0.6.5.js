(function(){var h=function(){var a=[].slice.call(arguments);a.push(h.options);if(a[0].match(/^\s*#([\w:\-\.]+)\s*$/igm)){a[0].replace(/^\s*#([\w:\-\.]+)\s*$/igm,function(c,b){var j=document;var d=j&&j.getElementById(b);a[0]=d?(d.value||d.innerHTML):c})}if(arguments.length==1){return h.compile.apply(h,a)}if(arguments.length>=2){return h.to_html.apply(h,a)}};var g={escapehash:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},escapereplace:function(a){return g.escapehash[a]},escaping:function(a){return typeof(a)!=="string"?a:a.replace(/[&<>"]/igm,this.escapereplace)},detection:function(a){return typeof(a)==="undefined"?"":a}};var e=function(a){if(typeof(console)!=="undefined"){if(console.warn){console.warn(a);return}if(console.log){console.log(a);return}}throw (a)};var f=function(b,d){b=b!==Object(b)?{}:b;if(b.__proto__){b.__proto__=d;return b}var c=function(){};var a=Object.create?Object.create(d):new (c.prototype=d,c);for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i]}}return a};h.__cache={};h.version="0.6.5-stable";h.settings={};h.tags={operationOpen:"{@",operationClose:"}",interpolateOpen:"{{",interpolateClose:"}}",noneencodeOpen:"{{{",noneencodeClose:"}}}",commentOpen:"\\{#",commentClose:"\\}"};h.options={cache:true,strip:true,errorhandling:true,detection:true,_method:f({__escapehtml:g,__throw:e,__juicer:h},{})};h.tagInit=function(){var u=h.tags.operationOpen+"each\\s*([^}]*?)\\s*as\\s*(\\w*?)\\s*(,\\s*\\w*?)?"+h.tags.operationClose;var s=h.tags.operationOpen+"\\/each"+h.tags.operationClose;var r=h.tags.operationOpen+"if\\s*([^}]*?)"+h.tags.operationClose;var q=h.tags.operationOpen+"\\/if"+h.tags.operationClose;var b=h.tags.operationOpen+"else"+h.tags.operationClose;var a=h.tags.operationOpen+"else if\\s*([^}]*?)"+h.tags.operationClose;var p=h.tags.interpolateOpen+"([\\s\\S]+?)"+h.tags.interpolateClose;var d=h.tags.noneencodeOpen+"([\\s\\S]+?)"+h.tags.noneencodeClose;var c=h.tags.commentOpen+"[^}]*?"+h.tags.commentClose;var t=h.tags.operationOpen+"each\\s*(\\w*?)\\s*in\\s*range\\(([^}]+?)\\s*,\\s*([^}]+?)\\)"+h.tags.operationClose;var v=h.tags.operationOpen+"include\\s*([^}]*?)\\s*,\\s*([^}]*?)"+h.tags.operationClose;h.settings.forstart=new RegExp(u,"igm");h.settings.forend=new RegExp(s,"igm");h.settings.ifstart=new RegExp(r,"igm");h.settings.ifend=new RegExp(q,"igm");h.settings.elsestart=new RegExp(b,"igm");h.settings.elseifstart=new RegExp(a,"igm");h.settings.interpolate=new RegExp(p,"igm");h.settings.noneencode=new RegExp(d,"igm");h.settings.inlinecomment=new RegExp(c,"igm");h.settings.rangestart=new RegExp(t,"igm");h.settings.include=new RegExp(v,"igm")};h.tagInit();h.set=function(i,b){var c=this;var l=function(j){return j.replace(/[\$\(\)\[\]\+\^\{\}\?\*\|\.]/igm,function(k){return"\\"+k})};var a=function(k,j){var n=k.match(/^tag::(.*)$/i);if(n){c.tags[n[1]]=l(j);c.tagInit();return}c.options[k]=j};if(arguments.length===2){a(i,b);return}if(i===Object(i)){for(var d in i){if(i.hasOwnProperty(d)){a(d,i[d])}}}};h.register=function(a,b){var c=this.options._method;if(c.hasOwnProperty(a)){return false}return c[a]=b};h.unregister=function(a){var b=this.options._method;if(b.hasOwnProperty(a)){return delete b[a]}};h.template=function(b){var a=this;this.options=b;this.__interpolate=function(p,c,n){var o=p.split("|"),d=o[0]||"",m;if(o.length>1){p=o.shift();m=o.shift().split(",");d="_method."+m.shift()+".call({}, "+[p].concat(m)+")"}return"<%= "+(c?"_method.__escapehtml.escaping":"")+"("+(!n||n.detection!==false?"_method.__escapehtml.detection":"")+"("+d+")) %>"};this.__removeShell=function(d,j){var c=0;d=d.replace(h.settings.forstart,function(r,p,i,o){var i=i||"value",o=o&&o.substr(1);var q="i"+c++;return"<% ~function() {for(var "+q+" in "+p+") {if("+p+".hasOwnProperty("+q+")) {var "+i+"="+p+"["+q+"];"+(o?("var "+o+"="+q+";"):"")+" %>"}).replace(h.settings.forend,"<% }}}(); %>").replace(h.settings.ifstart,function(l,i){return"<% if("+i+") { %>"}).replace(h.settings.ifend,"<% } %>").replace(h.settings.elsestart,function(i){return"<% } else { %>"}).replace(h.settings.elseifstart,function(l,i){return"<% } else if("+i+") { %>"}).replace(h.settings.noneencode,function(i,l){return a.__interpolate(l,false,j)}).replace(h.settings.interpolate,function(i,l){return a.__interpolate(l,true,j)}).replace(h.settings.inlinecomment,"").replace(h.settings.rangestart,function(i,o,r,p){var q="j"+c++;return"<% ~function() {for(var "+q+"="+r+";"+q+"<"+p+";"+q+"++) {{var "+o+"="+q+"; %>"}).replace(h.settings.include,function(i,n,m){return"<%= _method.__juicer("+n+", "+m+"); %>"});if(!j||j.errorhandling!==false){d="<% try { %>"+d;d+='<% } catch(e) {_method.__throw("Juicer Render Exception: "+e.message);} %>'}return d};this.__toNative=function(c,d){return this.__convert(c,!d||d.strip)};this.__lexicalAnalyze=function(i){var p=[];var s=[];var t="";var r=["if","each","_","_method","console","break","case","catch","continue","debugger","default","delete","do","finally","for","function","in","instanceof","new","return","switch","this","throw","try","typeof","var","void","while","with","null","typeof","class","enum","export","extends","import","super","implements","interface","let","package","private","protected","public","static","yield","const","arguments","true","false","undefined","NaN"];var c=function(j,k){if(Array.prototype.indexOf&&j.indexOf===Array.prototype.indexOf){return j.indexOf(k)}for(var l=0;l<j.length;l++){if(j[l]===k){return l}}return -1};var q=function(k,j){j=j.match(/\w+/igm)[0];if(c(p,j)===-1&&c(r,j)===-1&&c(s,j)===-1){if(typeof(window)!=="undefined"&&typeof(window[j])==="function"&&window[j].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i)){return k}if(typeof(global)!=="undefined"&&typeof(global[j])==="function"&&global[j].toString().match(/^\s*?function \w+\(\) \{\s*?\[native code\]\s*?\}\s*?$/i)){return k}if(typeof(h.options._method[j])==="function"||h.options._method.hasOwnProperty(j)){s.push(j);return k}p.push(j)}return k};i.replace(h.settings.forstart,q).replace(h.settings.interpolate,q).replace(h.settings.ifstart,q).replace(h.settings.elseifstart,q).replace(h.settings.include,q).replace(/[\+\-\*\/%!\?\|\^&~<>=,\(\)\[\]]\s*([A-Za-z_]+)/igm,q);for(var d=0;d<p.length;d++){t+="var "+p[d]+"=_."+p[d]+";"}for(var d=0;d<s.length;d++){t+="var "+s[d]+"=_method."+s[d]+";"}return"<% "+t+" %>"};this.__convert=function(d,c){var j=[].join("");j+="'use strict';";j+="var _=_||{};";j+="var _out='';_out+='";if(c!==false){j+=d.replace(/\\/g,"\\\\").replace(/[\r\t\n]/g," ").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out;";return j}j+=d.replace(/\\/g,"\\\\").replace(/[\r]/g,"\\r").replace(/[\t]/g,"\\t").replace(/[\n]/g,"\\n").replace(/'(?=[^%]*%>)/g,"\t").split("'").join("\\'").split("\t").join("'").replace(/<%=(.+?)%>/g,"';_out+=$1;_out+='").split("<%").join("';").split("%>").join("_out+='")+"';return _out.replace(/[\\r\\n]\\s+[\\r\\n]/g, '\\r\\n');";return j};this.parse=function(d,j){var c=this;if(!j||j.loose!==false){d=this.__lexicalAnalyze(d)+d}d=this.__removeShell(d,j);d=this.__toNative(d,j);this._render=new Function("_, _method",d);this.render=function(i,l){if(!l||l!==a.options._method){l=f(l,a.options._method)}return c._render.call(this,i,l)};return this}};h.compile=function(c,d){if(!d||d!==this.options){d=f(d,this.options)}try{var b=this.__cache[c]?this.__cache[c]:new this.template(this.options).parse(c,d);if(!d||d.cache!==false){this.__cache[c]=b}return b}catch(a){e("Juicer Compile Exception: "+a.message);return{render:function(){}}}};h.to_html=function(b,a,c){if(!c||c!==this.options){c=f(c,this.options)}return this.compile(b,c).render(a,c._method)};typeof(module)!=="undefined"&&module.exports?module.exports=h:this.juicer=h})();