define(function(m){var h=m("prober");var l=h.browser.name=="ie",j=l&&h.browser.version<"7";function n(){this.iframe=$("<iframe></iframe>").addClass("alertify-wrapper-iframe");this.el=$("<div/>").addClass("alertify-wrapper clearfix");this.ctn=$("<div/>").addClass("alertify-wrapper-ctn");this.ctnInner=$("<div/>").addClass("alertify-wrapper-ctn-inner");this.ctnInnerContWrapper=$("<div/>");this.contElStr="<i></i>";this.body=$("body");this.init()}n.prototype={constructor:n,init:function(){this.runningTime=400;this.stayTime=1000;this.timeId=null;this.ctn.appendTo(this.el);this.ctnInner.appendTo(this.ctn);if(l){this.iframe.appendTo(this.ctnInner)}this.ctnInnerContWrapper.appendTo(this.ctnInner);this.el.appendTo(this.body)},showInfo:function(d,g,a,e){var f=this;var c=e?e:f.stayTime;if(typeof g!=="undefined"&&$.trim(g)!==""){clearTimeout(f.timeId);if(this.running){try{this.el.stop().hide()}catch(b){}this.ctnInnerContWrapper.removeClass();clearTimeout(this.timeId);typeof f.callback==="function"&&f.callback()}this.callback=a;this.running=true;this.ctnInnerContWrapper.addClass(d).html(this.contElStr+g);this.setPosition();try{this.el.fadeIn(this.runningTime,function(){if(_.indexOf(n.manualType,f.currentType)===-1){f.timeId=setTimeout(function(){f.hideInfo()},c)}})}catch(b){this.el.css({opacity:1,display:"block"});f.timeId=setTimeout(function(){f.hideInfo()},c)}}},hideInfo:function(){var b=this;try{this.el.fadeOut(this.runningTime,function(){typeof b.callback==="function"&&b.callback();b.ctnInnerContWrapper.removeClass();b.running=false})}catch(a){this.el.css({opacity:0,display:"none"});typeof b.callback==="function"&&b.callback();b.ctnInnerContWrapper.removeClass();b.running=false}},setPosition:function(){var e=document.documentElement.clientHeight;try{var c=this.el.innerHeight()}catch(a){var c=this.el.height()}var d=(e-c)/2;this.iframe.css("height",c+"px");if(j){var b={position:"absolute",top:d+$(window).scrollTop()+"px"};this.el.css(b)}else{this.el.css("top",d+"px")}},hide:function(b,a){var b=typeof b==="number"?b:this.runningTime,c=this;if(!this.running){return}if(this.el.fadeOut){this.el.fadeOut(b,function(){typeof a==="function"&&a();c.ctnInnerContWrapper.removeClass();c.running=false})}else{this.el.hide();c.ctnInnerContWrapper.removeClass();c.running=false}}};n.automaticType=["log","error","success"];n.manualType=["loading"];var i=new n(),k={hide:function(b,a){var b=b,a=a;if(arguments.length===1&&typeof arguments[0]==="function"){a=b;b=null}i.hide(b,a)}};_.each(n.automaticType.concat(n.manualType),function(a,b){k[a]=function(){var c=arguments[0];if(a==="loading"){c||(c="加载中，请稍后...")}i.currentType=a;i.showInfo("alertify-"+a,c,arguments[1],arguments[2])}});return k});