define(function(m,n,l){var o,p,k,j;p=m("modules/widget/dialog/mask");k='<a href="javascript:void(0);" class="ico_close J_close">关闭</a>';j='<h3 class="dialog_title J_title">{title}</h3>';o=Backbone.View.extend({options:{width:"",height:"",hasMark:true,hasClose:true,isRemoveAfterHide:true,isAutoShow:true,title:"",className:"",effect:"fade",draggable:true,onShow:function(){},onHide:function(){}},events:{"click .J_close":"_close"},initialize:function(a){if(a){this.options=_.extend(this.options,a)}this._status=false;this.$el=$('<div class="dialog"/>').append(this.$el.show()).addClass(this.options.className).appendTo(document.body);this._isShowTitle();this._isShowClose();this._adjustPosition();this.on("show",function(){this._status=true;this._toggle("show")});this.on("hide",function(){this._status=false;this._toggle("hide")});this.on("show",this.options.onShow,this.$el);this.on("hide",this.options.onHide,this.$el);if(this.options.isAutoShow){this.trigger("show")}this._setDraggable()},_getStyle:function(a){var b,c;b=this.options.width;c=this.options.height;if(c&&this.options.title!=""){c=c+30}var a={width:b,height:c,"margin-left":-(b/2),"margin-top":-(c/2)};return a},_isShowTitle:function(){var a=this.options.title;if(a!=""){this.$title=$(j.replace("{title}",a)).prependTo(this.$el)}},_isShowClose:function(){if(this.options.hasClose){$(k).attr("hidefocus","true").appendTo(this.$el)}},_close:function(){this.trigger("hide")},_toggle:function(a){var b,c;b=this.options.effect;c=this;if(a=="show"){if(b==="none"){this.$el.css("display","block")}else{if(b==="fade"){this.$el.fadeIn()}}}else{if(a=="hide"){if(b==="none"){this.$el.css("display","none")}else{if(b==="fade"){this.$el.fadeOut()}}if(this.options.isRemoveAfterHide){setTimeout(function(){c.$el.remove()},2000)}}}this._toggleMask(a)},_toggleMask:function(a){if(this.options.hasMark){if(a=="show"){p.show()}else{if(a=="hide"){p.hide()}}}},_adjustPosition:function(){var a={width:this.options.width||this.$el.innerWidth(),height:this.options.height?(this.options.title!=""?this.options.height+30:this.options.height):this.$el.innerHeight()};this.$el.css(_.extend({marginLeft:-(a.width/2),marginTop:-(a.height/2)},a))},_setDraggable:function(){var b=this,c=this.options.draggable,a=this.options.title;if(c){m(["modules/widget/jquery-draggable-min"],function(){var e={containment:p.element||"body",scroll:false},d;if(a){d="h3.J_title";e.handle=d;$(d).css("cursor","move")}b.$el.draggable(e)})}},status:function(){return this._status?"show":"hide"},show:function(){this.trigger("show");return this},hide:function(){this.trigger("hide");return this},destroy:function(){this.$el.remove();p.hide()},resize:function(a,b){this.options.width=a;this.options.height=b;this._adjustPosition();return this},title:function(a){this.$title&&this.$title.html(a);return this}});function i(a,b){b=b||{};b.el=a||"<b></b>";return new o(b)}return i});