var swipeCard=function(c){var a=this;var b={container:document.getElementById("cardBox"),minTimes:2,maxTimes:10,timesCallBack:undefined};if(!c){c={}}if(typeof c.container==="undefined"){c.container=b.container}if(typeof c.minTimes==="undefined"){c.minTimes=b.minTimes}if(typeof c.maxTimes==="undefined"){c.maxTimes=b.maxTimes}if(typeof c.timesCallBack==="undefined"){c.timesCallBack=b.timesCallBack}this.container=c.container;this.minTimes=c.minTimes;this.maxTimes=c.maxTimes;this.timesCallBack=c.timesCallBack;this.cardList=[];this.timeId=undefined;this.rollTimes=0;this.awardId=undefined;this.getAwd=false;this.running=false;this.userOpenCard=false;$(".cardPo").each(function(d,e){a.cardList.push([$(e),$(e).css("top"),$(e).css("left")])});this.sayHello=function(){console.log("swipeCard say hello.")};this.cardGo=function(){a.reSet();a.centerAllCard();a.running=true;setTimeout(function(){a.rollCard()},2000)};this.setAward=function(e){if(a.running){console.log("设置奖励"+e);a.awardId=e;a.getAwd=true;$(".awardTxt").each(function(f,g){if((f+1)==e){$(g).css("display","block")}});var d=new Swiper("#txtSwiper",{scrollbar:".swiper-scrollbar",direction:"vertical",slidesPerView:"auto",mousewheelControl:true,freeMode:true,autoHeight:true,scrollbarHide:false})}};this.endRoll=function(e){a.running=false;a.rePosAllCard();if(e==false){console.log("显示超时");setTimeout(function(){$("#popAlert").addClass("md-show")},500)}else{if(e==true){$(".txt").addClass("txtShow");for(var d=0;d<$(".cardBox").children().length;d++){$(".cardBox").children()[d].cid=d;$($(".cardBox").children()[d]).click(function(){if(!a.userOpenCard){a.userOpenCard=true;a.clearSection(this.cid);$(this).css("z-index",1);$(this).removeClass("withBounce").addClass("poShow");$(".cardHead").html('<img src="images/cardHead'+a.awardId+'.png">');$(this).children(".card").children(".front").html('<img src="images/card'+a.awardId+'.png">');$(this).children(".card").removeClass("open").addClass("big")}})}}}};this.clearSection=function(d){$(".cardPo").each(function(e,f){if(f.cid!=d){$(f).addClass("fadeout")}});$(".txt").removeClass("txtShow");$(".cardHead").addClass("fadein");$(".shareBtn").addClass("fadein");$(".homeBtn").addClass("fadein");$(".progBtn").addClass("fadein");$(".noteBtn").addClass("fadein");$.post("/award/open").done(function(e){console.log(e)});console.log("select card:"+d)};this.centerAllCard=function(){$.each(a.cardList,function(d,e){setTimeout(function(){e[0].addClass("poCenter")},d*200)})};this.rollCard=function(){if(a.running){a.rollTimes++;if(typeof(a.timesCallBack)=="function"){a.timesCallBack()}$.each(a.cardList,function(d,e){setTimeout(function(){var f=e[0].children(".card");f.addClass("rollCard");f.on("webkitAnimationEnd",function(g){f.removeClass("rollCard")})},(6-d)*100)});a.timeId=setTimeout(function(){if(a.rollTimes>=a.maxTimes){if(a.getAwd==true){a.endRoll(true)}else{a.endRoll(false)}}else{if((a.rollTimes>=a.minTimes)&&(a.getAwd==true)){a.endRoll(true)}else{a.rollCard()}}},2000)}};this.rePosAllCard=function(){clearTimeout(a.timeId);$.each(a.cardList,function(d,e){setTimeout(function(){e[0].removeClass("poCenter")},d*200)})};this.reSet=function(){a.timeId=undefined;a.rollTimes=0;a.awardId=undefined;a.getAwd=false}};